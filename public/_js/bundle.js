(()=>{"use strict";class t{constructor(){this.root=document.querySelector("#root")}}class e extends(function(t){return class extends t{setRepository(t){return this.repository=t,this}}}(function(t){return class extends t{setRouter(t){return this.router=t,this.router.init(),this}}}(function(t){return class extends t{setPages(...t){return this.pages=t.map((t=>new t(this))),this}}}(t)))){}class s{constructor(t){this.element=document.createElement(t)}}class n extends(function(t){return class extends t{text(t){return this.element.innerText=t,this}}}(function(t){return class extends t{click(t){return this.element.onclick=t,this}}}(function(t){return class extends t{class(...t){return this.element.classList.add(...t),this}}}(function(t){return class extends t{atribs(t){for(const e in t)this.element.setAttribute(e,t[e]);return this}atrib(t,e){return this.element.setAttribute(t,e),this}}}(function(t){return class extends t{children(...t){return t.forEach((t=>{"string"==typeof t?this.element.innerHTML+=t:this.element.appendChild(t.element)})),this}}}(function(t){return class extends t{object(t){return t(this),this}}}(function(t){return class extends t{on(t,e){return Object.prototype.hasOwnProperty.call(this.element,`on${t}`)?this.element[`on${t}`]=e:console.error(`Event: on${t} doesn't exist in ${this.element}`),this}}}(function(t){return class extends t{HTML(t){return this.element.innerHTML=t,this}}}(s))))))))){constructor(t){super(t)}}function i(t){return new n(t)}class r{constructor(t,e,s){this.key="",this.key=e,this.parent=t,this.newComponent=s}get(t,e,s){return"object"==typeof t[e]&&null!==t[e]?new Proxy(t[e],new r(s,e,this.newComponent)):t[e]}set(t,e,s,n){return t[e]=s,null===this.parent?this.newComponent.create(n):this.parent[this.key]=t,!0}}class o{constructor(t){this.app=t}watch(t){const e=new Proxy(this,{set:(t,e,s)=>{var n;return"main"===e&&(null===(n=t.main.element.parentElement)||void 0===n||n.replaceChild(s.element,t.main.element)),t[e]=s,!0}});return[new Proxy(t,new r(null,"",e)),e]}}class a extends o{}class c extends o{constructor(t,e){super(t),this.main=i("div"),this.adapter=e,this.fields={title:"",description:""}}async create(t){return this.main=i("div").children(i("h3").text(t.title),i("p").text(t.description))}}class h extends o{constructor(t,e){super(t),this.main=i("div"),this.card=e}async create(t){return this.main=i("div").children(i("h2").text(t.title),...await Promise.all(t.list.map((async e=>{const[s,n]=new this.card(this.app,t.adapter).watch(e);return await n.create(s)}))))}}class l{static async push(t){window.location.hash=t}}class u extends l{static remove(){this.on&&window.history.back(),this.cb()}}u.on=!1;class d{constructor(t){this.app=t}async build(t){var e;this.app.root.innerHTML="";const s={};console.log(this.app);const n=null===(e=this.app.pages)||void 0===e?void 0:e.find((e=>{if(e.route===t)return!0;{const n=e.route.split("/"),i=t.split("/");if(n.length!==i.length)return!1;for(const t in n){if(n[t]!==i[t]&&":"!==n[t][0])return!1;":"===n[t][0]&&(s[n[t].substring(1)]=i[t])}return!0}}));n?this.app.root.appendChild((await n.create()).element):this.app.root.appendChild((await(async()=>i("h1").object((t=>{t.element.innerText="Pagina nao encontrada"})))()).element)}}class p extends d{push(t){window.history.pushState({state:""},"",t),this.build(t)}}const m=new class extends e{};m.setRepository({}).setPages(class extends a{constructor(){super(...arguments),this.route="/",this.main=i("div")}async create(t){const[e,s]=new h(this.app,c).watch({adapter:"item",title:"Itens",list:[]});return e.list.push({title:"Teste0",description:"Testando lista"}),e.list.push({title:"Teste1",description:"Testando lista"}),e.list.push({title:"Teste2",description:"Testando lista"}),this.main=i("main").children(i("h1").text("Inicio de tudo"),await s.create(e))}}).setRouter(new class extends p{constructor(){super(...arguments),this.hash=u}init(){this.build(window.location.pathname),window.onpopstate=t=>{t.preventDefault(),this.hash.on?this.hash.on=!1:window.location.hash.length<=1&&this.build(window.location.pathname)},window.onhashchange=t=>{t.newURL.split("#").length>1?this.hash.on=!0:this.hash.remove()}}}(m)),console.log(m)})();